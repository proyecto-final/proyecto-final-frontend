<template>
  <ShDialog v-model="show" :title="vulnerability.name" width="600">
    <template #activator="{on: dialogOn}">
      <v-tooltip top class="mr-2">
        <template #activator="{on}">
          <span v-on="on" @click="dialogOn.click">
            <ShChip class="mx-1">
              <v-icon>
                mdi-link
              </v-icon>
              {{ cutTo(vulnerability.name, 16) }}
            </ShChip>
          </span>
        </template>
        <template #default>
          {{ vulnerability.name }}
        </template>
      </v-tooltip>
    </template>
    <template #default>
      <div class="my-4">
        <ShBody strong neutral>
          Nombre:
        </ShBody>
        <ShBody>{{ vulnerability.name }}</ShBody>
      </div>
      <v-divider />
      <div class="my-4">
        <ShBody strong neutral>
          Nivel:
        </ShBody>
        <ShChip :color="getColorFromLevel(vulnerability.level)">
          {{ vulnerability.level }}
        </ShChip>
      </div>
      <v-divider />
      <div class="my-4">
        <ShBody strong neutral>
          Origen:
        </ShBody>
        <ShChip :color="vulnerability.isCustom ? 'success' : 'primary'">
          {{ vulnerability.isCustom ? 'Usuario' : 'Sherlock' }}
        </ShChip>
      </div>
      <template v-if="vulnerability.references.length > 0">
        <v-divider />
        <div class="my-4">
          <ShBody strong neutral>
            Referencias:
          </ShBody>
          <a v-for="(reference, index) in vulnerability.references" :key="index" target="_blank" :href="reference">{{ reference }}</a>
        </div>
      </template>
    </template>
  </ShDialog>
</template>
<script>
export default {
  props: {
    vulnerability: {
      type: Object,
      required: true
    }
  },
  data: () => ({
    show: false
  }),
  methods: {
    cutTo (str, length) {
      return str.length > length ? `${str.substr(0, length - 3)}...` : str
    },
    getColorFromLevel (level) {
      return {
        low: 'success',
        medium: 'warning',
        high: 'error'
      }[level] || 'gray'
    }
  }
}
</script>
